<!DOCTYPE html>
<meta charset="utf-8">

<style type="text/css">

  svg {
  	border: 1px solid #f0f;
  }

</style>

<body>
	<h1>SC Data</h1>
    <div class="g-chart-container"></div>

</body>

<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

var margin = {top: 5, right: 10, bottom: 20, left: 20};

var chartContainer = d3.select(".g-chart-container");

var w = 600 - margin.left - margin.right,
    h = 400 - margin.top - margin.bottom;

d3.csv("revised_sc_votes.csv", ready);
function ready(err, data){
	if (err) throw "error loading data";
	//console.log(data);

	var votesByCase = d3.nest() //returns an array of the cases
  		.key(function(d) { return d.caseName; })
  		.entries(data);

  	 console.log(votesByCase); //all cases
  	// console.log(votesByCase[0]); //one case
  	// console.log(votesByCase[0].values[0]);  	  		  	  		
  	// console.log(votesByCase[0].values[0].caseName);

  	votesByCase.forEach(function(d){ //looping through cases
  		console.log(d.key + "!"); //case name
  		console.log(d.values + "!!");  //the justice votes within that case
  		d.values.forEach(function(z){ //looping through each justice for the individual cases
  			console.log(z.justiceName + " voted: " + z.direction + " and their vote was " + z.vote); //each justice who voted and how they voted
  			//z.newVar = z.justiceName + "!!!"; //making new data with relevant stuff
  		});
  	});

  	var xscale = d3.scaleLinear() //created to use later
		.domain([0,20]) //project this from data land...
		.range([0,w])//to pixel land

	var yscale = d3.scaleLinear() //created to use later
		.domain([0,10])
		.range([h,0])

	var xaxis = d3.axisBottom() //means the ticks will go below rather than above
		.scale(xscale) //needs to know scale to project along svg

	var yaxis = d3.axisLeft()
		.scale(yscale)
		//.tickSize(-w); //creates horiz dashed lines. we want the horizontal line size for the y axis to be the width

	var agroup = chartContainer.selectAll(".a-group") //grab all items that have this a-group characteristic in the svg
		.data(votesByCase) //here's my data that I am binding to the element
		.enter() //data should enter those elemnts
		.append("div") //append those circles
		.attr("class", "a-group")
		.attr("id", function(d){return d.key;})
		.attr("transform", function(d) { //d is the element at that index
			console.log("yo")
			return "translate(" + xscale(d.x) + "," + yscale(d.y) + ")"; //is this me scaling my dots
		});

		agroup.append("h4")
        .text(function(d) {
        	return d.key;
        });

	var svg = agroup.append("svg")
        .attr("width", w + margin.left + margin.right)
        .attr("height", h + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var redCircle = svg.append("circle") //append those circles
		.attr("r", 30) //they need a radius of size 3
		.attr("cx", 40)
		.attr("fill", "red")
		.attr("cy", 20);

	}


</script>
